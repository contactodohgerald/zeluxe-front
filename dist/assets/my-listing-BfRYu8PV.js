import{j as s,u,a as x,b as h,g as v,r as I,f as _,bu as B,L as K,p as L,as as $,h as l,S as N}from"./index-BQGAvRb0.js";import{C}from"./confirm-booking-payment-CJld9iR6.js";import{F as k}from"./form-search-Ihe4m3To.js";import{u as P}from"./get-listings-BeTtOIxE.js";import"./get-countries-XomYH-oX.js";import"./get-reviews-CH1a8Vu-.js";import{B as m}from"./get-category-DMwHXmbr.js";import{C as d}from"./modal-tC5wcTJS.js";import{B as T,W as O,T as H,j as Q,K as Y,u as W}from"./get-listings-Ca6lcEl9.js";const V=t=>s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 32 32",...t,children:s.jsx("path",{fill:"currentColor",d:"M16 2C8.2 2 2 8.2 2 16s6.2 14 14 14s14-6.2 14-14S23.8 2 16 2m5.4 21L16 17.6L10.6 23L9 21.4l5.4-5.4L9 10.6L10.6 9l5.4 5.4L21.4 9l1.6 1.6l-5.4 5.4l5.4 5.4z"})});function U(t){return s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",...t,children:s.jsx("path",{fill:"currentColor",d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"})})}const w="/assets/lists-3-DZXsW6KV.png",X=({listingId:t})=>h.patch(`/publish/listing/${t}`),Z=({mutationConfig:t}={})=>{const n=u(),{onSuccess:a,...c}=t||{};return x({onSuccess:(...r)=>{n.refetchQueries({queryKey:["listings"]}),a==null||a(...r)},...c,mutationFn:X})},G=({listingId:t})=>h.delete(`/listing/${t}`),J=({mutationConfig:t}={})=>{const n=u(),{onSuccess:a,...c}=t||{};return x({onSuccess:(...r)=>{n.invalidateQueries({queryKey:["listings"]}),a==null||a(...r)},...c,mutationFn:G})},R=({listingId:t})=>h.patch(`/close/listing/${t}`),ee=({mutationConfig:t}={})=>{const n=u(),{onSuccess:a,...c}=t||{};return x({onSuccess:(...r)=>{n.refetchQueries({queryKey:["listings"]}),a==null||a(...r)},...c,mutationFn:R})};var E=(t=>(t.admin="admin",t.owner="owner",t.renter="renter",t))(E||{});const se=()=>{var a,c;const t=v();return t!=null&&t.data?{checkAccess:I.useCallback(({allowedRoles:r})=>{var o,f;return!r||r.length===0?!1:r==null?void 0:r.includes((f=(o=t==null?void 0:t.data)==null?void 0:o.role)==null?void 0:f.name)},[t==null?void 0:t.data]),role:(c=(a=t==null?void 0:t.data)==null?void 0:a.role)==null?void 0:c.name}:{checkAccess:()=>!1,roll:null}},te=({policyCheck:t,allowedRoles:n,forbiddenFallback:a=null,children:c})=>{const{checkAccess:r}=se();let o=!1;return n&&(o=r({allowedRoles:n})),typeof t<"u"&&(o=t),s.jsx(s.Fragment,{children:o?c:a})},ne=({listingId:t})=>h.patch(`/admin/approve/listing/${t}`),ae=({mutationConfig:t}={})=>{const n=u(),{onSuccess:a,...c}=t||{};return x({onSuccess:(...r)=>{n.refetchQueries({queryKey:["admin-listings"]}),a==null||a(...r)},...c,mutationFn:ne})},re=({listingId:t})=>h.patch(`/admin/reject/listing/${t}`),ce=({mutationConfig:t}={})=>{const n=u(),{onSuccess:a,...c}=t||{};return x({onSuccess:(...r)=>{n.refetchQueries({queryKey:["admin-listings"]}),a==null||a(...r)},...c,mutationFn:re})},ie=({listings:t})=>{const{addNotification:n}=_(),a=v(),c=Z({mutationConfig:{onSuccess:()=>{n({type:"success",title:"Listing published successfully"})},onError:e=>{const i=l(e);n({type:"error",title:e==null?void 0:e.message,message:i})}}}),r=ae({mutationConfig:{onSuccess:()=>{n({type:"success",title:"Listing approved successfully"})},onError:e=>{const i=l(e);n({type:"error",title:e==null?void 0:e.message,message:i})}}}),o=J({mutationConfig:{onSuccess:()=>{n({type:"success",title:"success",message:"Listing Deleted successfully"})},onError:e=>{const i=l(e);n({type:"error",title:e==null?void 0:e.message,message:i})}}}),f=ee({mutationConfig:{onSuccess:()=>{n({type:"success",title:"success",message:"Listing Closed successfully"})},onError:e=>{const i=l(e);n({type:"error",title:e==null?void 0:e.message,message:i})}}}),p=ce({mutationConfig:{onSuccess:()=>{n({type:"success",title:"success",message:"Listing Rejected successfully"})},onError:e=>{const i=l(e);n({type:"error",title:e==null?void 0:e.message,message:i})}}}),M=e=>{c.mutate({listingId:e})},F=e=>{r.mutate({listingId:e})},S=e=>{o.mutate({listingId:e})},q=e=>{f.mutate({listingId:e})},z=e=>{p.mutate({listingId:e})};return!t||t.length===0?s.jsx("p",{children:"No items to display in this category"}):s.jsx(s.Fragment,{children:t.map(e=>{var i,g,j,y;return s.jsxs(d,{className:"mb-[1.63rem] w-full bg-[#D9D9D92B]",children:[s.jsxs("div",{className:"flex flex-col sm:flex-row md:items-center",children:[s.jsxs("div",{className:"mr-[1.4rem]",children:[s.jsx("img",{src:((i=e==null?void 0:e.images[0])==null?void 0:i.url)||w,className:"h-[10.3rem] max-w-[13.85rem] rounded-[1.41rem] object-cover",alt:"Listing Images",onError:D=>{const b=D.target;b.onerror=null,b.src=w}}),s.jsxs("p",{className:"font-raleway text-[1.02rem] font-[400] leading-[2.2rem] -tracking-[0.02em] text-[#0000007A]",children:["Listing will expire in ",B(e==null?void 0:e.duration)]})]}),s.jsxs("div",{className:"flex-grow",children:[s.jsx("h4",{className:"mb-[0.63rem] font-raleway text-[1.5rem] font-bold leading-[1.8rem] tracking-[0.03em] text-secondary",children:e.name}),s.jsxs("p",{className:"mb-[0.63rem] font-montserrat text-[1.1rem] font-semibold leading-[1.32rem] tracking-[0.03em] text-primary",children:["â‚¦",Number(e==null?void 0:e.price)]}),s.jsxs(m,{className:"mb-[0.58rem] rounded-[0.63rem] bg-primary p-[0.6rem] font-raleway text-[0.63rem] font-medium leading-[0.74rem] tracking-[0.03em] text-white shadow-none backdrop-blur-[10.09px] backdrop-filter",children:[(g=e==null?void 0:e.address)==null?void 0:g.nearest_landmark,","," ",e==null?void 0:e.address.country.name]}),s.jsxs("p",{className:"mb-[0.63rem] font-raleway text-[0.87rem] font-[400] leading-[1.02rem] tracking-[0.03em] text-black",children:[(e==null?void 0:e.reviews.length)||0," ",(e==null?void 0:e.reviews.length)<=1?"review":"reviews"]}),s.jsx("p",{className:"font-raleway text-[0.87rem] font-[400] leading-[1.02rem] tracking-[0.03em] text-black",children:"0 contact"})]}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("div",{className:"mb-[0.6rem]",children:s.jsxs(m,{onClick:()=>S(e.id),className:"flex items-center bg-transparent text-danger-5 shadow-none",children:[s.jsx(U,{}),s.jsx("span",{className:"ml-1 font-raleway text-[0.73rem] font-[400] leading-[0.85rem] tracking-[0.03em]",children:"Delete"})]})}),e.status!=="active"?s.jsx("div",{className:"mb-[0.6rem]",children:s.jsxs(K,{to:((y=(j=a==null?void 0:a.data)==null?void 0:j.role)==null?void 0:y.name)==="admin"?L.app.admin.listing.getHref(e==null?void 0:e.id):L.app.owner.listing.getHref(e==null?void 0:e.id),className:"flex items-center text-warning",children:[s.jsx($,{className:"md:ml-4"}),s.jsx("span",{className:"ml-1 font-raleway text-[0.73rem] font-[400] leading-[0.85rem] tracking-[0.03em]",children:"Edit"})]})}):null,s.jsx("div",{children:s.jsxs(m,{onClick:()=>q(e.id),className:"flex items-center bg-transparent text-secondary shadow-none",children:[s.jsx(V,{}),s.jsx("span",{className:"ml-1 font-raleway text-[0.73rem] font-[400] leading-[0.85rem] tracking-[0.03em]",children:"Close"})]})})]})]}),s.jsx("div",{className:"text-right",children:e.status==="draft"?s.jsx(m,{isLoading:c.isPending,onClick:()=>M(e.id),className:"rounded-md bg-success p-1 font-raleway font-bold text-white",children:"publish"}):""}),s.jsx(te,{allowedRoles:[E.admin],children:s.jsx("div",{className:"text-right",children:s.jsxs("div",{className:"flex gap-x-3",children:[s.jsx("div",{children:e.status==="review"?s.jsx(m,{isLoading:r.isPending,onClick:()=>F(e.id),className:"rounded-md bg-success p-1 font-raleway font-bold text-white",children:"Approve"}):""}),s.jsx("div",{children:e.status==="review"?s.jsx(m,{isLoading:p.isPending,onClick:()=>z(e.id),className:"rounded-md bg-danger p-1 font-raleway font-bold text-white",children:"Reject"}):""})]})})})]},e==null?void 0:e.id)})})},A=({listings:t})=>!t||Object.keys(t).length===0?s.jsx("p",{children:"No listings available"}):s.jsxs(T,{children:[s.jsx(O,{className:"",children:Object.keys(t).map(n=>s.jsx(H,{className:({selected:a})=>`mb-2 mr-4 w-[8.4rem] text-nowrap text-center capitalize ${a?"bg-primary text-white focus:outline-none":"bg-light text-black"} rounded-[1.66rem] pb-[1.45rem] pl-[1.98rem] pr-[1.98rem] pt-[1.45rem] align-middle`,children:n},n))}),s.jsx(Q,{className:"mt-4",children:Object.keys(t).map(n=>s.jsx(Y,{className:"",children:s.jsx(ie,{listings:t[n]})},n))})]}),oe=()=>{var a;const t=P({});if(t.isLoading)return s.jsx("div",{className:"flex h-48 w-full items-center justify-center",children:s.jsx(N,{size:"lg"})});const n=(a=t==null?void 0:t.data)==null?void 0:a.data;return n?s.jsx(d,{className:"mt-4",children:s.jsx(A,{listings:n})}):s.jsx(d,{children:s.jsx("p",{children:"You have no Listings Yet"})})},me=()=>s.jsx(C,{title:"My Listings",component:s.jsx(k,{}),children:s.jsx(oe,{})}),Le=Object.freeze(Object.defineProperty({__proto__:null,MyListingRoute:me},Symbol.toStringTag,{value:"Module"})),le=()=>{var a;const t=W({});if(t.isLoading)return s.jsx("div",{className:"flex h-48 w-full items-center justify-center",children:s.jsx(N,{size:"lg"})});const n=(a=t==null?void 0:t.data)==null?void 0:a.data;return n?s.jsx(d,{className:"mt-4",children:s.jsx(A,{listings:n})}):s.jsx(d,{children:s.jsx("p",{children:"You have no Listings Yet"})})},de=()=>s.jsx(C,{title:"My Listings",component:s.jsx(k,{}),children:s.jsx(le,{})}),we=Object.freeze(Object.defineProperty({__proto__:null,MyAdminListingRoute:de},Symbol.toStringTag,{value:"Module"}));export{we as a,Le as m};
