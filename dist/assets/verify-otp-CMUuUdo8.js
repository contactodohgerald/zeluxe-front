import{z as l,a as y,b as g,f as j,i as v,k as b,r as d,j as e,h as w,p as N}from"./index-CMbjzSXO.js";import{A as O}from"./password-reset-CEgizwO2.js";import{B as E}from"./get-category-D_4z0seI.js";import{F as P,I as S}from"./get-countries-D00X0R5n.js";import"./confirm-booking-payment-zrejkqYx.js";import"./not-found-BtJxH9CK.js";import"./get-listings-DRrhn1kK.js";import"./get-states-CxLu8I-w.js";import"./get-reviews-D6hE6ck7.js";const I=l.object({email:l.string().email("Invalid email address").optional(),type:l.string().optional(),otp:l.string().min(5,"OTP must be at least 5 characters").optional()}),T=({data:r})=>g.post("/auth/verify",r),A=({mutationConfig:r}={})=>{const{onSuccess:n,...m}=r||{};return y({mutationFn:T,onSuccess:(...o)=>{n==null||n(...o)},onError:o=>{console.error("Mutation error:",o)},...m})},z=()=>{const{addNotification:r}=j(),n=v(),m=N.auth.login.getHref(),o=b(t=>t.email),[c,x]=d.useState(""),u=d.useRef([]),f=A({mutationConfig:{onSuccess:()=>{r({type:"success",title:"OTP verified successfully"}),n(m)},onError:t=>{const a=w(t);r({type:"error",title:t==null?void 0:t.message,message:a})}}}),p=(t,a)=>{var i;if(a.length>1)return;const s=c.split("");s[t]=a,x(s.join("")),a&&t<4&&((i=u.current[t+1])==null||i.focus())},h=()=>{if(!o||c.length!==5){r({type:"error",title:"Invalid OTP. Please enter the full OTP"});return}const t={email:o,type:"account_activation",otp:c};f.mutate({data:t})};return e.jsx(O,{title:"",children:e.jsx("div",{className:"relative flex min-h-screen flex-col justify-center overflow-hidden bg-gray-50 py-12",children:e.jsx("div",{className:"relative mx-auto w-full max-w-lg rounded-2xl bg-white px-6 pb-9 pt-10 shadow-xl",children:e.jsxs("div",{className:"mx-auto flex w-full max-w-md flex-col space-y-16",children:[e.jsxs("div",{className:"flex flex-col items-center justify-center space-y-2 text-center",children:[e.jsx("div",{className:"text-3xl font-semibold",children:e.jsx("p",{children:"Email Verification"})}),e.jsx("div",{className:"flex flex-row text-sm font-medium text-gray-400",children:e.jsx("p",{children:"We have sent a code to your email ba**@dipainhouse.com"})})]}),e.jsx(P,{id:"verify-account",onSubmit:h,schema:I,children:({formState:t})=>e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-col space-y-16",children:[e.jsx("div",{className:"mx-auto flex w-full max-w-sm flex-row items-center justify-between",children:[...Array(5)].map((a,s)=>e.jsx(S,{ref:i=>u.current[s]=i,className:"flex h-16 w-16 items-center justify-center rounded-xl border border-gray-200 bg-white text-center text-lg outline-none focus:border focus:border-primary focus:bg-gray-50 focus:ring-1",type:"text",maxLength:1,"aria-label":`OTP digit ${s+1}`,error:t.errors.otp,value:c[s],onChange:i=>p(s,i.target.value)},s))}),e.jsx("div",{className:"flex flex-col space-y-5",children:e.jsx("div",{children:e.jsx(E,{form:"verify-account",isLoading:f.isPending,type:"submit",className:"flex w-full flex-row items-center justify-center rounded-xl border border-none bg-success py-5 text-center text-sm text-white shadow-sm outline-none",children:"Verify Account"})})})]})})})]})})})})};export{z as VerifyOtpRoute};
